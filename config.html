<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>Config</title>
        <!-- librerias de estilos y js jquery y zoe -->
<link href="js/jquery-mobile/jquery.mobile.icons-1.4.5.min.css" rel="stylesheet" type="text/css"/>
<link href="js/jquery-mobile/jquery.mobile.theme-1.4.5.min.css" rel="stylesheet" type="text/css"/>
<link href="js/jquery-mobile/jquery.mobile.structure-1.4.5.min.css" rel="stylesheet" type="text/css"/>
<script src="js/jquery/jquery-2.1.4.js" type="text/javascript"></script>
<script src="js/jquery-mobile/jquery.mobile-1.4.5.min.js" type="text/javascript"></script>
<script type="text/javascript" src="phonegap.js"></script>
<script src="js/zoe/zoe.js" type="text/javascript"></script>
<script src="js/zoe/zoesync.js" type="text/javascript"></script>
<script src="js/zoe/salesRepDAO.js" type="text/javascript"></script>
<!-- fin librerias -->

<script>
	function localpageinit(){
		console.log("en localpageinit config.html");
		$('#salesRepName').val(window.localStorage.getItem("salesRepName"));	
		$('#submitConfig').click(submitFormConfig);	
		$('#sycSalesRep').click(syncSalesRep);	
	}

	function submitFormConfig(form) {
		window.localStorage.setItem("salesRepName", $('#salesRepName').val());
		return false;
	}
	
	function syncSalesRep(form){
		console.log("entre a syncSalesRep");
		var mensaje = 	
		'		<EmployeeQueryRq requestID="c1">\
				<FullName>' + window.localStorage.getItem("salesRepName") + '</FullName>\
				 <OwnerID>0</OwnerID>\
				</EmployeeQueryRq>';
			
		consumeWS(mensaje, "JSON", receiveMessage);
		return false;
	}
	
	function receiveMessage(message){
		var employee = message.EmployeeQueryRs;
		var salesRepVO = {id_salesRep:employee.EmployeeRet.ListID,
			name:employee.EmployeeRet.Name, 
			password:employee.EmployeeRet.DataExtRet[0].DataExtValue, 
			isActive:employee.EmployeeRet.isActive, 
			syncTime:Date.now()};
			
		salesRepDAO.insert(salesRepVO, errInsert, successInsert);
	}
	
	function successInsert(){
		Alert("Success sync salesRep");
	}

	function errInsert(){
		Alert("Error ons sync salesRep");
	}
</script>
</head>

<body>

        <div data-role="page" id="config" data-title="Config">
        
            <div data-role="content"> 
                <form method="post" onsubmit="return submitForm(this)" id="configForm" data-ajax="false">
                    <lable for="salesRepName">Piloch Sales Rep Full Name</lable><input type="text" id="salesRepName" name="salesRepName" placeholder="salesRepName"><br>
                                 
                        <input id="submitConfig" type="submit" value="Save">
		                <button class="ui-btn" id="sycSalesRep">Synch Sales Rep</button>
                </form>
				<div id="messageConfig" hidden="true"></div> 
 
            </div>
        

<!-- divs de header, menu y footer-->
	<div data-role="header" data-position="fixed" data-id="theheader" class="app-header"></div>
    <div data-role="panel" data-display="overlay" data-position="left" id="menu" class="app-menu"></div>
	<div data-role="footer" data-position="fixed" data-id="thefooter" class="app-footer"></div>
<!-- fin divs -->

</div>

</body>
</html>
